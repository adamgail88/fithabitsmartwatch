var dev_mode=app_config.dev_mode;function stateFilter(e,t){var a="";return $.each(t,(function(t,n){for(var o=0;o<e.length;o++){if(new RegExp("\\b^"+e[o]+"\\b").test(n.name)){a=t;break}if(new RegExp("\\b"+n.name+"\\b").test(e[o])){a=t;break}}})),""!==a||$.each(t,(function(t,n){for(var o=0;o<e.length;o++){var i=e[o].replace(/^county\s+/i,"");if(new RegExp("\\b"+i+"\\b").test(n.name)){a=t;break}}})),a}function checkMasking(e){if("undefined"!=typeof validator_data&&validator_data.hasOwnProperty("enable_ca_statecode_validation")){var t=$("[name="+e+"Country]").val();validator_data[t.toLowerCase()+"_state_code_mask"]?$("input[name="+e+"Zip]").mask(validator_data[t.toLowerCase()+"_state_code_mask"]):$("input[name="+e+"Zip]").unmask()}}$((function(){"undefined"!=typeof autocomplete_event_type&&""!=autocomplete_event_type||(autocomplete_event_type="blur");var e,t,a=(e=0,function(t,a){clearTimeout(e),e=setTimeout(t,a)});if("undefined"!=typeof autopopulate_by&&"address"==autopopulate_by)var n=$("input[name$=Address1]");else n=$("input[name=zip], input[name$=Zip]");console.log(n),n.on(autocomplete_event_type,(function(){var e,n,o,i,s=[],l=$(this);a((function(){if(!(l.val().length<4&&"keyup"==autocomplete_event_type||void 0!==t&&l.val()===t)){t=l.val();var a="";l.attr("name").match(/Zip$/)?a=l.attr("name").replace(/Zip$/,""):l.attr("name").match(/Address1$/)&&(a=l.attr("name").replace(/Address1$/,""));var p="",r=!1,d=$("[name$=Country]").val();if(($("[name$=Country] option").length<3||""!=d)&&(r=!0),""==d&&(d=$("[name=shippingCountry]").val()),"undefined"!=typeof google){var m=new google.maps.Geocoder,_={};"zip"!==autopopulate_by||disable_component_restriction||(_.postalCode=l.val(),r&&void 0!==d&&-1==["US"].indexOf(d)&&(_.country=d)),console.log(_),m.geocode({address:l.val(),componentRestrictions:_},(function(t,l){if("Y"==dev_mode&&console.log(t,l),"OK"===l&&0!==t.length&&t[0].hasOwnProperty("address_components")){e=t[0].address_components;var r=!1,m=!1;for(var _ in e)-1!==e[_].types.indexOf("locality")||-1!==e[_].types.indexOf("sublocality")||-1!==e[_].types.indexOf("neighborhood")||-1!==e[_].types.indexOf("postal_town")&&!r||-1!==e[_].types.indexOf("administrative_area_level_2")&&-1!==e[_].types.indexOf("political")&&!r?(n=e[_].long_name,r=!0):-1===e[_].types.indexOf("administrative_area_level_1")||r||(n=e[_].long_name),-1!==e[_].types.indexOf("administrative_area_level_1")&&(s.push(e[_].long_name),m=!0),-1===e[_].types.indexOf("administrative_area_level_2")||m||(s.push(e[_].long_name),m=!0),-1===e[_].types.indexOf("political")||-1!==e[_].types.indexOf("country")||m||(s.push(e[_].long_name),m=!0),-1!==e[_].types.indexOf("postal_code")&&(o=e[_].long_name),-1!==e[_].types.indexOf("country")&&(d=e[_].short_name);0!=app_config.allowed_country_codes.indexOf(d)>-1&&(i=app_config.countries[d].states,p=stateFilter(s,i),"Y"==dev_mode&&console.log(n+","+p+","+d),"undefined"!=typeof autopopulate_by&&"address"==autopopulate_by&&$("[name="+a+"Zip]").val(o),$("[name="+a+"City]").val(n),$("[name="+a+"City]").trigger("blur"),$("[name$=Country]").val(d).change(),setTimeout((function(){($("[name=state] option, [name$=State] option").length||$("[name=state] [type=text], [name$=State] [type=text]").length)&&(""!==p?($("[name=state], [name="+a+"State]").val(p),$("[name=state], [name="+a+"State]").trigger("blur")):(p=stateFilter([n],i),$("[name=state], [name="+a+"State]").val(p),$("[name=state], [name="+a+"State]").trigger("blur")))}),500),checkMasking(a))}}))}}}),1e3)}))}));